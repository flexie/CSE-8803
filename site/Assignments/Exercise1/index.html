<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Exercise 1: a first look at seismic data - Imaging w/ data-driven models</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">Imaging w/ data-driven models</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../../outline/">Outline</a>
                            </li>
                            <li >
                                <a href="../../goals/">Goals</a>
                            </li>
                            <li >
                                <a href="../../reading/">Reading</a>
                            </li>
                            <li >
                                <a href="../../homework/">Assigments</a>
                            </li>
                            <li >
                                <a href="../../project/">Projects</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#exercise-1-a-first-look-at-seismic-data">Exercise 1: a first look at seismic data</a></li>
        <li class="main "><a href="#scaning-the-dataset">Scaning the dataset</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="exercise-1-a-first-look-at-seismic-data">Exercise 1: a first look at seismic data</h1>
<p>In this exercise we will load some data into Julia and perform some basic operations.</p>
<p>Seismic data are typically stored in a special binary format: SEGY. These file-formats store the data as mutliple time-series (traces) with the corresponding header information containing specific information about such as time sampling and source/receiver locations.</p>
<pre><code>The Julia utilities for reading  SEGY data is SeisIO
</code></pre>
<pre><code class="julia">using SeisIO, PyPlot
</code></pre>

<h1 id="scaning-the-dataset">Scaning the dataset</h1>
<p>Thhe first step is to scan the dataset to extract header/metadat. This metadat contains the geometry and parameters of the survey such as the source/receiver locations and time sampling rate.
The convention for the metadata is as follows:
   - The Source positions use the <code>Source</code> keyword such as <code>SourceX</code>
   - The receiver position use the <code>Group</code> keyword such as <code>GroupX</code></p>
<pre><code class="julia"># scan the dataset

dir = Pkg.dir(&quot;SeisIO&quot;)
data_dir = &quot;/src/data&quot;

</code></pre>

<pre><code>"/src/data"
</code></pre>
<p>We ca nnow scans the dataset with the <code>segy_scan</code> functin. This function returns a <code>SeisCOn</code> object where each block is a shot record with its metadata.</p>
<pre><code class="julia">blocks = segy_scan(string(dir, data_dir), &quot;overthrust&quot;, [&quot;GroupX&quot;, &quot;GroupY&quot;, &quot;ns&quot;, &quot;dt&quot;]);
</code></pre>

<pre><code>Scanning ... /nethome/mlouboutin3/.julia/v0.6/SeisIO/src/data/overthrust_2D_shot_41_60.segy
Scanning ... /nethome/mlouboutin3/.julia/v0.6/SeisIO/src/data/overthrust_2D_shot_21_40.segy
Scanning ... /nethome/mlouboutin3/.julia/v0.6/SeisIO/src/data/overthrust_2D_shot_61_80.segy
Scanning ... /nethome/mlouboutin3/.julia/v0.6/SeisIO/src/data/overthrust_2D_shot_1_20.segy
Scanning ... /nethome/mlouboutin3/.julia/v0.6/SeisIO/src/data/overthrust_2D_shot_81_97.segy
</code></pre>
<p>Now extract the time, source and receiver coordinates (in seconds and meters) for all the traces. The source and receiver vectors have a length equal to the number of traces, the time vector has a length equal to the number of rows in the data matrix.</p>
<pre><code class="julia">sx = [get_header(blocks[i], &quot;SourceX&quot;) for i=1:length(blocks)];
rx = [get_header(blocks[i], &quot;GroupX&quot;) for i=1:length(blocks)];
</code></pre>

<pre><code class="julia"># Get the tme axis. In this case the time axis is the same for all traces so we only need to extract it from the first trace
# dt needs to be corrected for the binary setup
# All the times are in ms
dt = get_header(blocks[1], &quot;dt&quot;)[1]/1000
nt = get_header(blocks[1], &quot;ns&quot;)[1]
T = 0:dt:(nt-1)*dt
</code></pre>

<pre><code>0.0:4.0:3000.0
</code></pre>
<p>Calculate the offset and midpoint for each trace. This gives you vectors m (midpoint) and h (offset) with length equal to the number of traces.</p>
<p>h = (s - r)/2;</p>
<p>m = (s + r)/2;</p>
<pre><code class="julia">h = (sx .- rx)./2;
m = (sx .+ rx)./2;
</code></pre>

<p>The fold of the data is the number of traces in each midpoint gather. This can be easily visualized by a histogram.
As we have a set of <code>blocks</code> we need to inspect each block seperately to recover the nuique set of midpoint location and the total number fo traces for this midpoint</p>
<pre><code class="julia">all_m = hcat(m'...)
fold = [sum(all_m .== unique(all_m)[i]) for i=1:length(unique(all_m))];

all_h = hcat(h'...);
</code></pre>

<pre><code class="julia">figure();
bar(unique(all_m),fold ,align=&quot;center&quot;, width=100);
xlabel(&quot;midpoint [m]&quot;);
ylabel(&quot;fold&quot;);
title(&quot;fold&quot;);
</code></pre>

<p><img alt="png" src="../../img/Untitled_13_0.png" /></p>
<p>Can you interpret this figure?</p>
<p>Different gathers</p>
<p>Extract a midpoint gather. For example, a midpoint gather at m = 2550 looks like this:</p>
<pre><code class="julia">Im = find(all_m .== 7500.)
figure()
imshow(Float32.(blocks[1:97].data[:, Im]), vmin=-1, vmax=1, cmap=&quot;Greys&quot;, aspect=.05)
</code></pre>

<p><img alt="png" src="../../img/Untitled_16_0.png" /></p>
<pre><code>PyObject &lt;matplotlib.image.AxesImage object at 0x7f947ac9a550&gt;
</code></pre>
<p>Extract an offset-gather. For example, a zero-offset section looks like:</p>
<pre><code class="julia"># We need to sort it in physical units as the dataset may not be
Ih = find(all_h .== 0.)
inds = sortperm(all_m[Ih]')
figure()
imshow(Float32.(blocks[1:97].data[:, Ih[inds]]), vmin=-1, vmax=1, cmap=&quot;Greys&quot;, aspect=.1)
</code></pre>

<p><img alt="png" src="../../img/Untitled_18_0.png" /></p>
<pre><code>PyObject &lt;matplotlib.image.AxesImage object at 0x7f947ab7f048&gt;
</code></pre>
<p>What other different gathers can you think of? Extract and plot an example of all the different gathers. What are characteristic properties of the different gathers? Do not forget to label the axis and choose a reasonable colorscale. Hint: use <code>cmap=Greys</code> and adjust the color-axis <code>vmin/vmax</code></p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
